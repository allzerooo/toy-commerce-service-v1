= User Service API Documentation
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 3
:sectlinks:
:sectnums:

[[overview]]
= 개요

User Service는 사용자 관리를 담당하는 마이크로서비스입니다.

본 문서는 User Service의 REST API 사용 방법을 설명합니다.

[[overview-http-verbs]]
== HTTP 동사

본 REST API에서 사용하는 HTTP 동사는 가능한 한 표준 HTTP와 REST 규약을 따릅니다.

|===
| 동사 | 용례

| `GET`
| 리소스를 가져올 때 사용

| `POST`
| 새 리소스를 만들 때 사용

| `PUT`
| 기존 리소스를 전체 수정할 때 사용

| `PATCH`
| 기존 리소스의 일부를 수정할 때 사용

| `DELETE`
| 기존 리소스를 삭제할 때 사용
|===

[[overview-http-status-codes]]
== HTTP 상태 코드

본 REST API에서 사용하는 HTTP 상태 코드는 가능한 한 표준 HTTP와 REST 규약을 따릅니다.

|===
| 상태 코드 | 용례

| `200 OK`
| 요청을 성공적으로 처리함

| `201 Created`
| 새 리소스를 성공적으로 생성함

| `204 No Content`
| 요청을 성공적으로 처리했으나 응답 본문에 데이터가 없음

| `400 Bad Request`
| 잘못된 요청 (유효성 검증 실패 등)

| `401 Unauthorized`
| 인증되지 않은 요청

| `403 Forbidden`
| 권한이 없는 요청

| `404 Not Found`
| 존재하지 않는 리소스에 대한 요청

| `409 Conflict`
| 리소스 충돌 (예: 중복 데이터)

| `500 Internal Server Error`
| 서버 내부 오류
|===

[[overview-response-format]]
== 공통 응답 형식

모든 API는 다음과 같은 공통 응답 형식을 따릅니다.

=== 성공 응답

[source,json]
----
{
  "success": true,
  "code": "SUCCESS",
  "message": "요청이 성공했습니다.",
  "data": {
    // 실제 응답 데이터
  },
  "timestamp": "2024-01-01T00:00:00Z"
}
----

|===
| 필드 | 타입 | 설명

| `success`
| `Boolean`
| API 처리 성공 여부 (항상 true)

| `code`
| `String`
| 응답 코드 (성공 시 "SUCCESS")

| `message`
| `String`
| 응답 메시지

| `data`
| `Object`
| 실제 응답 데이터

| `timestamp`
| `String`
| 응답 생성 시각 (ISO-8601 형식)
|===

=== 실패 응답

[source,json]
----
{
  "success": false,
  "code": "VALIDATION_ERROR",
  "message": "입력값 검증에 실패했습니다.",
  "errors": [
    {
      "field": "email",
      "message": "유효하지 않은 이메일 형식입니다"
    }
  ],
  "timestamp": "2024-01-01T00:00:00Z"
}
----

|===
| 필드 | 타입 | 설명

| `success`
| `Boolean`
| API 처리 성공 여부 (항상 false)

| `code`
| `String`
| 에러 코드

| `message`
| `String`
| 에러 메시지

| `errors`
| `Array`
| 필드별 에러 목록 (선택적)

| `errors[].field`
| `String`
| 에러가 발생한 필드명

| `errors[].message`
| `String`
| 필드별 에러 메시지

| `timestamp`
| `String`
| 응답 생성 시각 (ISO-8601 형식)
|===

[[user-roles]]
== 사용자 역할

사용자는 다음 중 하나 이상의 역할을 가질 수 있습니다.

|===
| 역할 | 설명

| `BUYER`
| 구매자 - 상품을 구매할 수 있는 권한

| `SELLER`
| 판매자 - 상품을 등록하고 판매할 수 있는 권한

| `ADMIN`
| 관리자 - 시스템 전체를 관리할 수 있는 권한
|===

[[user-status]]
== 사용자 상태

사용자는 다음 중 하나의 상태를 가집니다.

|===
| 상태 | 설명

| `ACTIVE`
| 활성 - 정상적으로 서비스를 이용할 수 있는 상태

| `INACTIVE`
| 비활성 - 탈퇴 등으로 서비스를 이용할 수 없는 상태

| `SUSPENDED`
| 정지 - 관리자에 의해 일시적으로 서비스 이용이 제한된 상태
|===

[[user-api]]
= 사용자 API

[[user-register]]
== 회원가입

`POST` 요청을 사용해서 새로운 사용자를 등록할 수 있습니다.

=== 요청

include::{snippets}/user-register/http-request.adoc[]

include::{snippets}/user-register/request-fields.adoc[]

=== 응답

include::{snippets}/user-register/http-response.adoc[]

include::{snippets}/user-register/response-fields.adoc[]

=== 예제

==== curl

[source,bash]
----
$ curl -X POST 'http://localhost:8080/api/v1/users' \
  -H 'Content-Type: application/json' \
  -d '{
    "email": "test@example.com",
    "password": "Test1234!@#$",
    "userRole": "BUYER"
  }'
----

[[user-register-fail]]
== 회원가입 실패 케이스

=== 이메일 형식 오류

이메일 주소가 올바른 형식이 아닌 경우 `400 Bad Request`가 반환됩니다.

include::{snippets}/user-register-fail-invalid-email/http-request.adoc[]

include::{snippets}/user-register-fail-invalid-email/http-response.adoc[]

=== 비밀번호 조건 불충족

비밀번호가 보안 정책을 만족하지 못하는 경우 `400 Bad Request`가 반환됩니다.

비밀번호는 다음 조건을 모두 만족해야 합니다:

* 8자 이상 100자 이하
* 대문자 최소 1개 포함
* 소문자 최소 1개 포함
* 숫자 최소 1개 포함
* 특수문자 최소 1개 포함

include::{snippets}/user-register-fail-weak-password/http-request.adoc[]

include::{snippets}/user-register-fail-weak-password/http-response.adoc[]
